using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using DB = DiversityCollection;
using Model = DiversityService.Model;

namespace DiversityService
{
    public static class ModelProjection
    {
        public static DB.CollectionEventSeries ToEntity(this Model.EventSeries model)
        {        
            return new DB.CollectionEventSeries()
            {
                //SeriesID Autogenerated 
                DateStart = model.SeriesStart,
                DateEnd = model.SeriesEnd,
                Description = model.Description,
                SeriesCode = model.SeriesCode,
                //TODO Geography    
            
                RowGUID = Guid.NewGuid(),
            };
        }

        public static Model.EventSeries ToModel(this DB.CollectionEventSeries entity)
        {
            return new Model.EventSeries()
            {
                SeriesID = entity.SeriesID,
                SeriesStart = entity.DateStart,
                SeriesEnd = entity.DateEnd,
                Description = entity.Description,
                SeriesCode = entity.SeriesCode,
                LogUpdatedWhen = entity.LogUpdatedWhen
                //TODO Geography                
            };
        }

        public static DB.CollectionEvent ToEntity(this Model.Event model)
        {
            return new DB.CollectionEvent()
            {
                CollectionEventID = model.EventID,
                SeriesID = model.SeriesID,

                CollectionYear = (short)model.CollectionDate.Year,
                CollectionMonth = (byte)model.CollectionDate.Month,
                CollectionDay = (byte)model.CollectionDate.Day,
                LocalityDescription = model.LocalityDescription,
                HabitatDescription = model.HabitatDescription,
                
                //TODO CollectingMethod
                

                RowGUID = Guid.NewGuid(),
            };
        }

        public static Model.Event ToModel(this DB.CollectionEvent entity)
        {
            return new Model.Event()
            {
                EventID = entity.CollectionEventID,
                SeriesID = entity.SeriesID,

                CollectionDate = 
                (entity.CollectionYear != null && entity.CollectionMonth != null && entity.CollectionDay != null) ? 
                    new DateTime((int)entity.CollectionYear, (int)entity.CollectionMonth, (int)entity.CollectionDay) 
                    : DateTime.Now, 
                LocalityDescription = entity.LocalityDescription,
                HabitatDescription = entity.HabitatDescription,
                
            };
        }
    }
}
